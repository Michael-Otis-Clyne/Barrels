Cdata_all$Trt[i] = barrelkey$Trt[barrelkey$BARREL == Cdata_all$BARREL[i]]
Cdata_all$LH_combo[i] = barrelkey$LH_combo[barrelkey$BARREL == Cdata_all$BARREL[i]]
Cdata_all$Spec.TRT[i] = barrelkey$Species[barrelkey$BARREL==Cdata_all$BARREL[i]]
}
diff.plot <- Cdata_all %>%
mutate(., Trt = ifelse(Trt == "1", "Control", "Repeated")) %>%
mutate(., BARREL = `Barrel ID`,
"I-F" = as.numeric(BRTE),
"N-F" = as.numeric(LAGL),
"N-M" = as.numeric(`ELEL count`),
"N-S" = as.numeric(`ARTR count`)) %>%
select(., BARREL, Trt, "I-F", "N-F", "N-M", "N-S")
Cdata_all
Cdata_all
Cdata_all %>%
mutate(., Trt = ifelse(Trt == "1", "Control", "Repeated"))
diff.plot <- Cdata_all %>%
mutate(., Trt = ifelse(Trt == "1", "Control", "Repeated")) %>%
mutate(., BARREL = `Barrel ID`,
"I-F" = as.numeric(BRTE),
"N-F" = as.numeric(LAGL),
"N-M" = as.numeric(`ELEL count`),
"N-S" = as.numeric(`ARTR count`)) %>%
select(., BARREL, Trt, "I-F", "N-F", "N-M", "N-S")
diff.plot <- Cdata_all %>%
mutate(., Trt = ifelse(Trt == "1", "Control", "Repeated")) %>%
mutate(., BARREL = `Barrel ID`,
"I-F" = as.numeric(BRTE),
"N-F" = as.numeric(LAGL),
"N-M" = as.numeric(`ELEL count`),
"N-S" = as.numeric(`ARTR count`))
diff.plot <- Cdata_all %>%
mutate(., Trt = ifelse(Trt == "1", "Control", "Repeated")) %>%
mutate(., "I-F" = as.numeric(BRTE),
"N-F" = as.numeric(LAGL),
"N-M" = as.numeric(`ELEL count`),
"N-S" = as.numeric(`ARTR count`)) %>%
select(., BARREL, Trt, "I-F", "N-F", "N-M", "N-S")
diff.plot <- Cdata_all %>%
mutate(., Trt = ifelse(Trt == "1", "Control", "Repeated")) %>%
mutate(., "I-F" = as.numeric(BRTE),
"N-F" = as.numeric(LAGL),
"N-M" = as.numeric(`ELEL count`),
"N-S" = as.numeric(`ARTR count`))
Cdata_all
Cdata_all
diff.plot <- Cdata_all %>%
mutate(., Trt = ifelse(Trt == "1", "Control", "Repeated"))
diff.plot
ggplot(data = diff.plot, mapping = aes(x = SPECIES, y = total)) +
geom_boxplot(stat = "identity")
ggplot(data = diff.plot, mapping = aes(x = SPECIES, y = total)) +
geom_boxplot(mapping = aes(color = Year))
ggplot(data = diff.plot, mapping = aes(x = SPECIES, y = total)) +
geom_boxplot(aes(color = Year))
Cdata_all
count_new <- Cdata_all %>%
select(BARREL, SPECIES, total, Trt) %>%
pivot_wider(names_from = SPECIES, values_from = total, values_fill = 0)
# Step 1. Pivot wide to match old "count24"
count_new <- Cdata_all %>%
select(BARREL, SPECIES, total, Trt) %>%
pivot_wider(names_from = SPECIES, values_from = total, values_fill = 0)
conflict_prefer("select", "dplyr")
library(conflicted)
conflict_prefer("select", "dplyr")
ep 1. Pivot wide to match old "count24"
# Step 1. Pivot wide to match old "count24"
count_new <- Cdata_all %>%
select(BARREL, SPECIES, total, Trt) %>%
pivot_wider(names_from = SPECIES, values_from = total, values_fill = 0)
rlang::last_trace()
count_new <- Cdata_all %>%
select(BARREL, SPECIES, total, Trt) %>%
pivot_wider(
names_from = SPECIES,
values_from = total,
values_fill = list(total = 0)
)
rlang::last_trace()
rlang::last_trace(drop = FALSE)
count_new <- Cdata_all %>%
select(BARREL, SPECIES, total, Trt) %>%
tidyr::pivot_wider(
names_from = SPECIES,
values_from = total,
values_fill = 0   # no list, just a plain 0
)
Cdata_all
Cdata_all %>%
select(BARREL, SPECIES, total, Trt)
count_new <- Cdata_all %>%
select(BARREL, SPECIES, total, Trt) %>%
tidyr::pivot_wider(
names_from = SPECIES,
values_from = total,
values_fill = 0   # no list, just a plain 0
)
total
Cdata_all
count_new <- Cdata_all %>%
select(BARREL, SPECIES, total, Trt) %>%
tidyr::pivot_wider(
names_from = SPECIES,
values_from = total,
values_fill = list(total = as.numeric(0))
)
packageVersion("tidyr")
install.packages(c("abind", "AlgDesign", "ape", "asbio", "askpass", "bayesplot", "bayestestR", "BH", "bigD", "bit", "bit64", "bitops", "bookdown", "boot", "brms", "broom", "bslib", "Cairo", "car", "checkmate", "class", "classInt", "cli", "clubSandwich", "cluster", "colorspace", "commonmark", "corrplot", "cowplot", "cpp11", "crosstalk", "curl", "data.table", "datawizard", "dbplyr", "Deriv", "DHARMa", "diffobj", "digest", "distributional", "doBy", "DT", "dtplyr", "e1071", "effects", "effectsize", "elevatr", "evaluate", "fastmatch", "FNN", "fontawesome", "foreign", "fs", "future", "future.apply", "gap", "gargle", "generics", "ggeffects", "ggh4x", "ggplot2", "ggpubr", "ggrepel", "ggridges", "glmmTMB", "globals", "glue", "googledrive", "googlesheets4", "GPArotation", "gstat", "gt", "gWidgets2", "gWidgets2tcltk", "haven", "httpuv", "igraph", "inline", "insight", "inspectdf", "intervals", "jpeg", "jsonlite", "KernSmooth", "knitr", "later", "lattice", "lavaan", "lme4", "lubridate", "maps", "markdown", "MASS", "Matrix", "MatrixModels", "matrixStats", "mgcv", "microbenchmark", "mime", "miniUI", "minqa", "mvtnorm", "ncdf4", "nFactors", "nlme", "nloptr", "nnet", "openssl", "parallelly", "parameters", "patchwork", "pbkrtest", "performance", "permute", "phangorn", "phytools", "pillar", "pixmap", "pkgbuild", "plotly", "posterior", "processx", "progressr", "promises", "ps", "psych", "purrr", "qgam", "quantreg", "QuickJSR", "R6", "ragg", "raster", "rbibutils", "Rcpp", "RcppArmadillo", "RcppEigen", "RcppParallel", "Rdpack", "reactR", "readxl", "rlang", "rmarkdown", "rpart", "rprojroot", "rstan", "rstantools", "rstudioapi", "rsvg", "rvest", "s2", "sandwich", "sass", "scales", "sf", "sftime", "shiny", "sjmisc", "sjPlot", "sjstats", "sp", "spacetime", "spatial", "StanHeaders", "stars", "stringi", "stringr", "survey", "survival", "svglite", "sys", "systemfonts", "terra", "testthat", "textshaping", "TH.data", "threejs", "tibble", "tinytex", "TMB", "tzdb", "units", "usmap", "usmapdata", "utf8", "uuid", "V8", "vegan", "visNetwork", "waldo", "withr", "wk", "writexl", "xfun", "xml2", "xts", "yaml", "zoo"))
count_new <- Cdata_all %>%
select(BARREL, SPECIES, total, Trt) %>%
tidyr::pivot_wider(
names_from = SPECIES,
values_from = total,
values_fill = list(total = as.numeric(0))
)
library(tidyverse)
# Step 2. Recode treatment (match old labels)
count_new <- count_new %>%
mutate(Trt = recode(Trt,
`1` = "Control",
`2` = "Repeated"))
library(tidyverse)
# Receive
A <- 77 # bowers
B <- 40 # mid 26 1st
# Receive
A <- 77 # bowers
B <- 40 # mid 26 1st
sum(A, B)
# send
C <- 33 # loveland
D <- 78 # Hampton
E <- 15 # 26 mid 2nd
sum(C,D,E)
A+B > C+D+E
print(A+B > C+D+E)
F <- 40
sum(A, B, F)
print(A+B + F > C+D+E)
########################
### Barrel Data 2023 ###
########################
library(tidyverse)
library(dplyr)
library(readxl)
library(ggplot2)
setwd("~/Desktop/Github/Barrels")
# Load in data
data <- read_xlsx("Barrel_Data_2023_FINAL.xlsx")
soil <- read_xlsx("Barrel_Data_2023_FINAL.xlsx", sheet = 2)
brte.indv <- read_xlsx("Barrel_Data_2023_FINAL.xlsx", sheet = 3)
# da
# data <- read_xlsx("Barrel_Data_2023_CLYNE_RD.xlsx", sheet = 1)
# soil <- read_xlsx("Barrel_Data_2023_CLYNE_RD.xlsx", sheet = 2)
# Change inflorescence NAs to 0's
data <- data %>%
mutate(FLWR_1 = ifelse(is.na(FLWR_1), 0, FLWR_1),
FLWR_2 = ifelse(is.na(FLWR_2), 0, FLWR_2),
FLWR_3 = ifelse(is.na(FLWR_3), 0, FLWR_3),
FLWR_4 = ifelse(is.na(FLWR_4), 0, FLWR_4),
FLWR_5 = ifelse(is.na(FLWR_5), 0, FLWR_5),
FLWR_6 = ifelse(is.na(FLWR_6), 0, FLWR_6),
FLWR_7 = ifelse(is.na(FLWR_7), 0, FLWR_7),
FLWR_8 = ifelse(is.na(FLWR_8), 0, FLWR_8),
FLWR_9 = ifelse(is.na(FLWR_9), 0, FLWR_9))
data <- data %>% # Remove all Unknown plants
subset(., SPECIES != "U") %>%
subset(., SPECIES !="UG") %>%
subset(., SPECIES != "UD")
t
data <- data %>%
mutate(., LH = SPECIES) %>% # Create dummy column
mutate(., LH = ifelse(LH=="ELEL", "MEDIUM", "FAST")) %>% # create fast and medium
relocate(LH, .before = `PLANT ID`) %>% # relocate LH col to beginning
mutate(data, NvI = SPECIES) %>% # another dummy col to set up mutate
mutate(., NvI = ifelse(NvI == "BRTE", "INVASIVE", "NATIVE")) %>% # Create Native vs Invasive
relocate(NvI, .before = `PLANT ID` )
data <- data %>%
mutate(., LH = SPECIES) %>% # Create dummy column
mutate(., LH = ifelse(LH=="ELEL", "MEDIUM", "FAST")) %>% # create fast and medium
relocate(LH, .before = `PLANT ID`) %>% # relocate LH col to beginning
mutate(data, NvI = SPECIES) %>% # another dummy col to set up mutate
mutate(., NvI = ifelse(NvI == "BRTE", "INVASIVE", "NATIVE")) %>% # Create Native vs Invasive
relocate(NvI, .before = `PLANT ID` )
##############################################
### Merge the soil moisture data by Barrel ###
##############################################
# create a named vector
lookup <- c(BARREL = "BARREL", VWC_2 =  "VWC...2", VWC_3 = "VWC...4", VWC_4 = "VWC...6",  VWC_5 = "VWC...8",
VWC_6 ="VWC...10",  VWC_7 = "VWC...12", VWC_8 = "VWC...14", VWC_9 = "VWC...16")
soil <- soil %>%
select(., BARREL, contains("VWC")) %>% #select only VWC columns
rename(., all_of(lookup)) # rename by the named vector to match the time period of plant data collection
data <- data %>%
full_join(soil, by = "BARREL")
col_FLWR <- c("FLWR_1", "FLWR_2", "FLWR_3", "FLWR_4","FLWR_5", "FLWR_6","FLWR_7","FLWR_8", "FLWR_9")
data <- data %>%
mutate(., FLWRTotal =  apply(data[c(col_FLWR)], 1, max ))
col_FLWR <- c("FLWR_1", "FLWR_2", "FLWR_3", "FLWR_4","FLWR_5", "FLWR_6","FLWR_7","FLWR_8", "FLWR_9")
data <- data %>%
mutate(., FLWRTotal =  apply(data[c(col_FLWR)], 1, max ))
### Create new column for inflorescence total per individual
data <- data %>%
mutate(SEEDTotal = as.numeric(FLWRTotal))
for(i in 1:length(data$BARREL)){
if(data$SPECIES[i] == "LAGL"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*39)
}
if(data$SPECIES[i] == "ELEL"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*93)
}
if(data$SPECIES[i] == "BRTE"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*88)
}
}
for(i in 1:length(data$BARREL)){
if(data$SPECIES[i] == "LAGL"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*39)
}
if(data$SPECIES[i] == "ELEL"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*93)
}
if(data$SPECIES[i] == "BRTE"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*88)
}
}
for(i in 1:length(data$BARREL)){
if(data$SPECIES[i] == "LAGL"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*39)
}
if(data$SPECIES[i] == "ELEL"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*93)
}
if(data$SPECIES[i] == "BRTE"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*88)
}
}
col_FLWR <- c("FLWR_1", "FLWR_2", "FLWR_3", "FLWR_4","FLWR_5", "FLWR_6","FLWR_7","FLWR_8", "FLWR_9")
data <- data %>%
mutate(., FLWRTotal =  apply(data[c(col_FLWR)], 1, max ))
### Create new column for inflorescence total per individual
data <- data %>%
mutate(SEEDTotal = as.numeric(FLWRTotal))
#Edit this to have exact seed output per plant
for(i in 1:length(data$BARREL)){
if(data$SPECIES[i] == "LAGL"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*39)
}
if(data$SPECIES[i] == "ELEL"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*93)
}
if(data$SPECIES[i] == "BRTE"){
data$SEEDTotal[i] <-  (data$FLWRTotal[i]*88)
}
}
data
data$FLWRTotal
# Plot of the number of BRTE seeds per barrel
B.S.PLot <- ggplot(brte.indv, aes(x = `Barrel ID`, y = `wt to seeds`))+
geom_bar(stat = "identity")
B.S.PLot # need to make this more pretty
BRTEmean <- data %>%
filter(SPECIES == "BRTE") %>%
summarise(., BRTEavg = mean(SEEDTotal),
BRTEsd = sd(SEEDTotal),
se = sd(SEEDTotal) / sqrt(length(SEEDTotal)))
BRTEmean
forBob <- ggplot(data = Bobdata) +
geom_bar(aes(x = Species, y = Average, fill = Species), stat = "identity") +
geom_errorbar(aes(x = Species, ymin = Average-sd, ymax = Average+sd),
width=0.4, colour="black", alpha=1, linewidth= 0.5) + theme_light() +
ylab("Seeds") +
ggtitle("Mean Seed Production")+coord_flip()+
scale_fill_brewer(palette = "Dark2")
ELELmean <- data %>%
filter(SPECIES == "ELEL") %>%
summarise(., ELELavg = mean(SEEDTotal),
ELELsd = sd(SEEDTotal),
se = sd(SEEDTotal) / sqrt(length(SEEDTotal)))
ELELmean
LAGLmean <- data %>%
filter(SPECIES == "LAGL") %>%
summarise(., LAGLavg = mean(SEEDTotal),
LAGLsd = sd(SEEDTotal),
se = sd(SEEDTotal) / sqrt(length(SEEDTotal)))
LAGLmean
Bobdata <- tibble(Species = c("Native-Fast", "Native-Medium", "Invasive-Fast"),
Average = c(LAGLmean$LAGLavg, ELELmean$ELELavg, BRTEmean$BRTEavg) ,
sd = c(LAGLmean$LAGLsd, ELELmean$ELELsd, BRTEmean$BRTEsd),
se = c(LAGLmean$se, ELELmean$se, BRTEmean$se))
##### first
Bobdata
BRTEmean
library(tidyverse)
library(dplyr)
library(readxl)
library(ggplot2)
library(reshape2)
library(viridis)
library(conflicted)
conflict_prefer("select", "dplyr")
# Set WD for Desktop
# setwd("~/GitHub/Barrels")
# Set WD for laptop
setwd("/Users/michaelotisclyne/Desktop/Github/Barrels")
# Load in data
#countdata <- read_xlsx("2024 Data.xlsx", sheet = 1)
plantdata <- read_xlsx("2024 Data.xlsx", sheet = 4)
VWCdata <- read_xlsx("2024 Data.xlsx", sheet = 5)
# countdata <- countdata %>%
#   mutate(., BRTE = as.numeric(ifelse(`BRTE count` == "X", NA, `BRTE count`)),
#          LAGL = as.numeric(ifelse(`LAGL count` == "X", NA, `LAGL count`)),
#          ELEL = as.numeric(ifelse(`ELEL count` == "X", NA, `ELEL count`)),
#          ARTR = as.numeric(ifelse(`ARTR count` == "X", NA, `ARTR count`)))
#### COME UP WITH A WAY TO CALCULATE NUMBER OF NEW ELEL BASED ON SURVEY DATA, NT FROM 1ST SWEEP DATA ABOVE.
dim(plantdata %>% filter(SPECIES == "ELEL"))[1]
conflicted::conflicts_prefer(dplyr::filter)
library(tidyverse)
library(dplyr)
library(readxl)
library(ggplot2)
library(reshape2)
library(viridis)
library(conflicted)
conflict_prefer("select", "dplyr")
# Set WD for Desktop
# setwd("~/GitHub/Barrels")
# Set WD for laptop
setwd("/Users/michaelotisclyne/Desktop/Github/Barrels")
# Load in data
#countdata <- read_xlsx("2024 Data.xlsx", sheet = 1)
plantdata <- read_xlsx("2024 Data.xlsx", sheet = 4)
VWCdata <- read_xlsx("2024 Data.xlsx", sheet = 5)
# countdata <- countdata %>%
#   mutate(., BRTE = as.numeric(ifelse(`BRTE count` == "X", NA, `BRTE count`)),
#          LAGL = as.numeric(ifelse(`LAGL count` == "X", NA, `LAGL count`)),
#          ELEL = as.numeric(ifelse(`ELEL count` == "X", NA, `ELEL count`)),
#          ARTR = as.numeric(ifelse(`ARTR count` == "X", NA, `ARTR count`)))
#### COME UP WITH A WAY TO CALCULATE NUMBER OF NEW ELEL BASED ON SURVEY DATA, NT FROM 1ST SWEEP DATA ABOVE.
dim(plantdata %>% filter(SPECIES == "ELEL"))[1]
###### Create count data from toothpick sheet
plantdata <- plantdata %>%
mutate(FLWR_1 = ifelse(is.na(FLWR_1), 0, FLWR_1),
FLWR_2 = ifelse(is.na(FLWR_2), 0, FLWR_2))
speciescounts <- plantdata %>%
mutate(., ELEL = (SPECIES=="ELEL"),
ARTR = (SPECIES=="ARTR"),
BRTE = (SPECIES=="BRTE"),
LAGL = (SPECIES=="LAGL")) %>%
dplyr::select(., `BARREL #`, QUAD, HT_1, HT_2, FLWR_1, ELEL, BRTE, ARTR, LAGL, FLWR_2, SPECIES) %>%
filter(., SPECIES == "ELEL")
# mutate(., LH = SPECIES) %>% # Create dummy column
#   mutate(., LH = ifelse(LH=="ELEL", "MEDIUM", "FAST")) %>% # create fast and medium
#   relocate(LH, .before = `PLANT ID`) %>% # relocate LH col to beginning
#   mutate(data, NvI = SPECIES) %>% # another dummy col to set up mutate
#   mutate(., NvI = ifelse(NvI == "BRTE", "INVASIVE", "NATIVE")) %>% # Create Native vs Invasive
#   relocate(NvI, .before = `PLANT ID` )
###########################
### FOR ESA 2024 POSTER ###
###########################
# make a figure of number of plants survived to last survey in each year 1 and year 2
data23 <- read.csv("barrel_data_all.csv")
data24 <- read_xlsx("2024 Data_Clean.xlsx", sheet = 2)
count24 <- read_xlsx("2024 Data_Clean.xlsx", sheet = 1)
count24 <- count24[-161,] # get rid of "total" row
data24 <- data24 %>% rename(., BARREL = `BARREL #`, PLANT.ID = `PLANT ID`)
count.df <- tribble(
~SPECIES, ~Year1, ~Year2,
"ARTR", 0, count24 %>% select(`ARTR count`) %>% colSums(),
"ELEL", dim(filter(data23, SPECIES == "ELEL") %>% # how many ELEL survived to the last survey?
filter(., AorD_9 == "A"))[1],
count24 %>% select(`ELEL count`) %>% colSums(),
"BRTE", dim(filter(data23, SPECIES == "BRTE") %>% # how many BRTE reproduced at least 1 inflorescence?
filter(., FLWRTotal > 0))[1],
dim(data24 %>% filter(SPECIES == "ELEL"))[1],
"LAGL", dim(filter(data23, SPECIES == "LAGL") %>% # how many BRTE reproduced at least 1 inflorescence?
filter(., FLWRTotal > 0))[1],
count24 %>% select(`LAGL count`) %>% colSums()
)
data.comb <- tribble(
~SPECIES, ~YEAR, ~COUNT,
"ARTR", 2023, 0,
"ARTR", 2024, count24 %>% select(`ARTR count`) %>% colSums(),
"ELEL", 2023, dim(filter(data23, SPECIES == "ELEL") %>% # how many ELEL survived to the last survey?
filter(., AorD_9 == "A"))[1],
"ELEL", 2024, dim(data24 %>% filter(SPECIES == "ELEL"))[1],
"BRTE", 2023, dim(filter(data23, SPECIES == "BRTE") %>% # how many BRTE reproduced at least 1 inflorescence?
filter(., FLWRTotal > 0))[1],
"BRTE", 2024, count24 %>% select(`BRTE count`) %>% colSums(),
"LAGL", 2023, dim(filter(data23, SPECIES == "LAGL") %>% # how many BRTE reproduced at least 1 inflorescence?
filter(., FLWRTotal > 0))[1],
"LAGL", 2024, count24 %>% select(`LAGL count`) %>% colSums()
) %>% mutate(., YEAR = as.factor(YEAR), SPECIES =as.factor(SPECIES), COUNT = as.numeric(COUNT))
data.comb %>%
filter(., SPECIES == "ELEL") %>%
ggplot(., aes(fill=YEAR, x=SPECIES, y =COUNT)) +
geom_bar(position="stack", stat="identity")
data.comb %>%
filter(., SPECIES == "ARTR") %>%
ggplot(., aes(fill=YEAR, x=SPECIES, y =COUNT)) +
geom_bar(position="dodge", stat="identity")
nitial seeds per barrel #
init.seed <- tibble(ARTRtotal = 231*64, ELELtotal = 105*64, BRTEtotal = 130*96, LAGLtotal = 130*96)
init.seed <- init.seed %>%
mutate(., ARTRgerm = 0,
ELELgerm = dim(filter(data23, SPECIES == "ELEL") %>% # how many ELEL survived to the last survey?
filter(., AorD_9 == "A"))[1],
BRTEgerm = dim(filter(data23, SPECIES == "BRTE") %>% # how many BRTE reproduced at least 1 inflorescence?
filter(., FLWRTotal > 0))[1],
LAGLgerm = dim(filter(data23, SPECIES == "LAGL") %>% # how many LAGL reproduced at least 1 inflorescence?
filter(., FLWRTotal > 0))[1])
germ.plot2 <- tribble(
~SPECIES, ~YEAR ,~INIT.Seed, ~GERM.tot, ~prop.germ,
#--|--|----
"Native-Slow", 2023, init.seed$ARTRtotal, init.seed$ARTRgerm, (init.seed$ARTRgerm/init.seed$ARTRtotal), # initial seeding, germ tot and prop year 1
"Native-Slow", 2024, #year 2
data23 %>% filter(., SPECIES == "ARTR") %>% select(., SEEDTotal) %>% colSums() + (init.seed$ARTRtotal/2)*231, #total self seeded + repeat seed
data.comb %>% filter(SPECIES=="ARTR") %>% select(COUNT) %>% colSums(), # total germ in year 2
(data.comb %>% filter(SPECIES=="ARTR") %>% select(COUNT) %>% colSums())/(data23 %>% filter(., SPECIES == "ARTR") %>% select(., SEEDTotal) %>% colSums() + (init.seed$ARTRtotal/2)*231),  # germinated this year / total seeds in from last year + repeat seed
"Native-Medium", 2023, init.seed$ELELtotal, init.seed$ELELgerm, (init.seed$ELELgerm/init.seed$ELELtotal),
"Native-Medium", 2024, #year 2
data23 %>% filter(., SPECIES == "ELEL") %>% select(., SEEDTotal) %>% colSums() + (init.seed$ELELtotal/2)*105, #total self seeded + repeat seed
data.comb %>% filter(SPECIES=="ELEL") %>% select(COUNT) %>% colSums(), # total germ in year 2
(data.comb %>% filter(SPECIES=="ELEL") %>% select(COUNT) %>% colSums())/(data23 %>% filter(., SPECIES == "ELEL") %>% select(., SEEDTotal) %>% colSums() + (init.seed$ELELtotal/2)*105),  # germinated this year / total seeds in from last year + repeat seed
"Invasive-Fast", 2023, init.seed$BRTEtotal, init.seed$BRTEgerm, (init.seed$BRTEgerm/init.seed$BRTEtotal),
"Invasive-Fast", 2024,
data23 %>% filter(., SPECIES == "BRTE") %>% select(., SEEDTotal) %>% colSums(), #total self seeded // no repeat seed for BRTE
data.comb %>% filter(SPECIES=="BRTE") %>% select(COUNT) %>% colSums(), # total germ in year 2
(data.comb %>% filter(SPECIES=="BRTE") %>% select(COUNT) %>% colSums())/(data23 %>% filter(., SPECIES == "BRTE") %>% select(., SEEDTotal) %>% colSums()),  # germinated this year / total seeds in from last year
"Native-Fast", 2023, init.seed$LAGLtotal, init.seed$LAGLgerm, (init.seed$LAGLgerm/init.seed$LAGLtotal),
"Native-Fast", 2024,
data23 %>% filter(., SPECIES == "LAGL") %>% select(., SEEDTotal) %>% colSums() + (init.seed$LAGLtotal/2)*130, #total self seeded + repeat seed
data.comb %>% filter(SPECIES=="LAGL") %>% select(COUNT) %>% colSums(), # total germ in year 2
(data.comb %>% filter(SPECIES=="LAGL") %>% select(COUNT) %>% colSums())/(data23 %>% filter(., SPECIES == "LAGL") %>% select(., SEEDTotal) %>% colSums() + (init.seed$LAGLtotal/2)*130),  # germinated this year / total seeds in from last year + repeat seed
) %>% mutate(.,YEAR = as.factor(YEAR))
data23 %>% filter(., SPECIES == "ELEL") %>% select(., SEEDTotal) %>% colSums()  #this get all seeds produced by plants
# add re-seeded seed total
(init.seed$ELELtotal/2)*105
### change this to not inlcude species names, but ise Native and LH denominations instead
library(wesanderson)
names(wes_palettes)
ggplot(data = germ.plot2) +
geom_bar(aes(x = SPECIES, y = prop.germ, fill = YEAR), position = "dodge", stat = "identity")+
theme_light() +
ylab("Germination Proportion") +
ggtitle("Species Germination Rates In Each Year") +
scale_fill_manual(values = wes_palette("FrenchDispatch", n = 2))+
theme(legend.position = c(0.8,0.7), legend.background = element_rect(color = "black" , size=0.5, linetype="solid"))
##############################
### Make a plot that depicts if you can see a difference in treatments (initial seeding vs re-seed)
# Assign each barrel the treatments and LH combos
barrelkey <- read.csv("barrel_key.csv")
barrelkey$Species <- gsub("_[^_]+$","", barrelkey$Trt)
#remove trailing part about if control or not; irrelevant bc this is 1 year only
#barrelkey$LH_combo <- gsub("_[^_]+$","", barrelkey$LH_combo)
# remove the LH combo in the trt column
barrelkey$Trt <- gsub(".*_", "", barrelkey$Trt)
head(barrelkey)
#looks like it worked well; now to add life history key (manually)
unique(barrelkey$Trt)
barrelkey <- as_tibble(barrelkey %>% mutate(., Trt=as.factor(Trt)))
head(barrelkey)
#B = cheatgrass = F
#A = sagebrush = S
#L = whitedaisy = F
#E = bottlebrush = M
barrelkey <- barrelkey %>%
mutate(
LH_combo = ifelse(Species == "LE" | Species == "BE", "FM",
ifelse(Species == "BL", "FF",
ifelse(Species == "AL" | Species == "BA", "FS", NA)))
)
head(barrelkey)
#now add treatment and LH combo info to the main dataframe
#make new columns:
data24$Trt = NA
data24$LH_combo = NA
data24$Spec.TRT=NA
#fill in based on info in barrel key:
for (i in 1:nrow(data24)) {
data24$Trt[i] = barrelkey$Trt[barrelkey$BARREL == data24$BARREL[i]]
data24$LH_combo[i] = barrelkey$LH_combo[barrelkey$BARREL == data24$BARREL[i]]
data24$Spec.TRT[i] = barrelkey$Species[barrelkey$BARREL==data24$BARREL[i]]
}
head(data24[15:2])
#assign year column to each year's dataframe
data23$YEAR = 2023
data24$YEAR = 2024
# create DESIGNATION column for data23
data23 <- as.tibble(data23)
data23<- data23 %>%
mutate(., LH = SPECIES) %>% # Create dummy column
mutate(., LH = ifelse(LH=="BRTE" | LH == "LAGL", "F",
ifelse(LH == "ELEL", "M",
ifelse(LH == "ARTR", "S", NA)))) %>% # create fast and medium
relocate(LH, .before = PLANT.ID) %>% # relocate LH col to beginning
mutate(., NvI = SPECIES) %>% # another dummy col to set up mutate
mutate(., NvI = ifelse(NvI == "BRTE", "I", "N")) %>% # Create Native vs Invasive
mutate(., DESIGNATION = paste(NvI, LH, sep = "-")) %>%
relocate(NvI, .before =  PLANT.ID) %>%
relocate(DESIGNATION, .before =  PLANT.ID)
#######
# #get ELEL sums from each Barrel in data24
# elel.b.sum <- data24 %>%
#   filter(SPECIES == "ELEL") %>%   # select just ELEL
#   select(., BARREL, SPECIES, Trt) %>%
#   mutate(., Count = 1)
#
# elel.agg <- aggregate(Count~BARREL, elel.b.sum, FUN = sum) # sum all ELEL in each barrel
#
# write_csv(elel.agg, file="ELEL_SUM.csv")
